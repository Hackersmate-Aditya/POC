<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style.css">
        
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    
    <!-- Add Font Awesome CDN for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <title>Transcript Generation</title>

</head>
<body>    
    <!-- <header class="navbar navbar-expand-lg navbar-light mt-0 ">
        
        <div class="navbar-brand">
            <img src="/static/Infobeanslogo.png" alt="InfoBeans Logo" height="30">
        </div>

        
        <h3 class=" header-text navbar-text  text-white d-flex justify-content-center align-items-center">Image Generation</h3>

        
        <div class="flex-grow-1"></div>

        
        <div class="dropdown">
            <div  id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" >
                <i class="fa fa-ellipsis-v " aria-hidden="true"></i>
            </div>
            <div class="dropdown-menu dropdown-menu-right" aria-labelledby="dropdownMenuButton">                
                <a class="dropdown-item" href="/image_generation">Generate Image</a>
                <a class="dropdown-item" href="/summary_generation">Generate Summary</a>
                <a class="dropdown-item" href="/generate_transcript">Generate Transcript</a>
                <a class="dropdown-item" href="/supportcall_summary_generation">Financial summary</a>
                <a class="dropdown-item" href="/contract_summary_generation">Contract summary</a>
                <a class="dropdown-item" href="/generate_job">Job description</a>
            </div>
        </div>
    </header> -->
    <div class="container-fluid">
        <div class="row">
            {% include 'sidebar.html' %} 


            <main class="col-md-9 col-lg-10 offset-md-3 offset-lg-2 px-md-0" id="page-content">
                <div class="loader" id="loader"></div>  

                <!-- <header class="navbar navbar-expand-lg navbar-light mt-0  mr-0">
                    <h3 class=" header-text   text-white d-flex justify-content-center align-items-center">Transcript Generation</h3>
                    <div class="flex-grow-1"></div>
                </header> -->
                <div class=" mt-8 ">
            
                    {% if transcript %}
                    <div class="row mt-5 ext-center">
                        <div class="col-md-6 offset-md-3">
                            <h2>Transcript:</h2>
                            <p>{{ transcript }}</p>
                        </div>
                    </div>
                    {% endif %}

                    <form method="POST" enctype="multipart/form-data" class="fixed-bottom m-5">
                        <div id="audioPlayerContainer" style="display: none;">
                            <audio id="audioPlayer" controls>
                                <source src="" type="audio/mpeg">
                                Your browser does not support the audio element.
                              </audio>
                            </div>
                        <div class="form-group mt-2  text-right">
                            <button type="submit" class="btn btn-dark rounded-pill" id="generateTranscript">Upload and Transcribe</button>
                        </div>
                        <div class="custom-file">
                            <input type="file" class="custom-file-input" id="audioFile" name="audio" accept=".mp3, .wav" style="display: none;">
                            <label class="custom-file-label" for="audioFile">Choose an audio file (MP3 or WAV)</label>
                        </div>
                        <div id="selectedFileName"></div>
                        
                        <!-- <div class="form-group mt-2">
                            <button type="button" class="btn btn-primary" onclick="document.getElementById('audioFile').click();">Browse</button>
                        </div> -->
                       
                    </form>



                    <!-- <form action="/generate_image" method="post" class="fixed-bottom m-5">
                        <div class="form-group text-right">
                            <button type="submit" class="btn btn-dark rounded-pill" id="generateImage"><i class="fas fa-image"></i> Generate Image</button>
                        </div>
                        <div class="form-group input-text">
                            <input type="text" placeholder="Generate an image based on your text input" class="form-control" id="text" name="text">
                        </div>
                    </form> -->
                                      
                </div>
            </main>
        </div>
    </div>

     




    <!-- Footer -->
    {% include 'footer.html' %} 

    <script>
        // Get a reference to the file input element
const fileInput = document.getElementById("audioFile");
// Get a reference to the element where you want to display the file name
const selectedFileName = document.getElementById("selectedFileName");
const audioPlayer = document.getElementById('audioPlayer');

// Add an event listener to the file input to listen for changes
fileInput.addEventListener("change", function () {
// Check if a file has been selected
if (fileInput.files.length > 0) {
    // Display the selected file name in the designated element
    selectedFile= fileInput.files[0]
    selectedFileName.textContent = "Selected Audio file: " + fileInput.files[0].name;
    const objectURL = URL.createObjectURL(selectedFile);

// Set the audio player source to the URL
audioPlayer.src = objectURL;
audioPlayerContainer.style.display = 'block';

// Release the object URL when it's no longer needed to prevent memory leaks
audioPlayer.onended = function () {
URL.revokeObjectURL(objectURL);
};
} else {
    // If no file is selected, clear the displayed file name
    selectedFileName.textContent = "";
    audioPlayer.src = '';
    audioPlayerContainer.style.display = 'none';
}
});

// Function to show the loader
function showLoader() {
   document.getElementById("loader").style.display = "block";
}

// Function to hide the loader
function hideLoader() {
   document.getElementById("loader").style.display = "none";
}
document.getElementById("generateTranscript").addEventListener("click", function () {
   showLoader();
   // Get input text and prompt
   const inputText = document.getElementById("inputText").value;
   const prompt = document.getElementById("prompt").value;

   // Make a POST request to your Flask server to generate the summary
   fetch('/generate_transcript', {
       method: 'POST',
       headers: {
           'Content-Type': 'application/x-www-form-urlencoded',
       },
       body: `inputText=${encodeURIComponent(inputText)}&prompt=${encodeURIComponent(prompt)}`,
   })
   .then(response => response.json())
   .then(data => {
       // Display the generated summary on the web page
       const summaryResult = document.getElementById("summaryResult");
       summaryResult.innerHTML = "<h2>Generated Transcript:</h2>" + data.summary;
       selectedFileName.textContent="";
       hideLoader();
   })
   .catch(error => {
       console.error('Error:', error);
   });
});
</script>



   
    <!-- Include Bootstrap JavaScript and jQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
     
</body>
</html>
